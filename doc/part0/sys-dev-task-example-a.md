# 复杂产品示例一

购物车结算流程：
* 购物车结算时，生成一条购物清单
    * 支持多商品
    * 同一商品支持多个生产批次
    * 过期商品拦截（对于食品药品类商品非常重要！）
        * 不允许自助结算，同时通知店员处理（隐匿处理）
        * 生成故障，并通知调查员追查原因
* 根据付款方式生成一条付款单（支持多种结算方式）
    * 支持多路径结算
        * 支持会员价（购买会员入口）
        * 支持代金券、优惠券、金额满减、商品满减活动，支持商品打折
        * 支持信用卡/银行卡优惠活动
    * 支持多种付款方式
        * 支持现金支付（仅限店员结账）
        * 支持电子支付
            * 支持`App`内付款码支付打折
            * 支持微信/支付宝/银联扫支付单二维码付款（手机扫结算机）
            * 支持扫描微信/支付宝/银联提供的付款二维码付款（结算机扫手机）
    * 支持结算成功后，返点活动，会员积分累计
* 付款订单支付成功后，扣减商品库存
* 支持退货
    * 支持尾号快速查单
        * 小票单号尾数6位
    * 支持退多类商品
        * 上限为购买数量
        * 优化退批次新的商品
    * 确认退款前重新计价
        * 商品满减时不支持部分退货
        * 金额满减时重新计价
    * 退款单
        * 按重新计价结果，将差价按原支付原路径返回
        * 商品增加的备货数量，标记为“退货状态”（待人工查验后入库）
        * 扣除积分，扣除返点
